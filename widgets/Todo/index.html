<div class='ui medium form'>
	<div class='fields'>
		<div class='field' class='ui two stackable'>
			<input placeholder='Add new' type='text' id='todoInput' class="in-form">
		</div>
		<div id='outstandingTodos' class='todo-list'></div>
	</div>
</div>

<script type="text/javascript">

	var Todo = {

	isSubmitShown: false,
	numTodos: 0,

	init: function(todos)
	{
		Todo.createFormListeners();
	},

	createFormListeners: function()
	{
		// makes the form submit button look pretty
		Todo.makeNewTodoFieldClickable();
	},

	makeNewTodoFieldClickable: function()
	{
		$(".in-form").click(function(){

			var who = $(this)[0].id;
			
			$("#" + who).keyup(function(event){

				// grab the current val
				var val = $("#" + who).val();

				// show/hide submit
				if (val.length >= 1) Todo.showSubmit(who);
				else Todo.hideSubmit();

			});


		});
	},

	showSubmit: function(who)
	{
		if (!Todo.isSubmitShown)
		{
			var submitButton = "<div class='in-form-submit'>Submit</div>";

			$(submitButton).hide().appendTo($("#" + who).parent()).fadeIn().addClass("nudge");

			$(".in-form-submit").click(function(){
				Todo.generateTodo();
			});

			$("#todoInput").keyup(function(event){
				// add event listener so you can hit enter
				if (event.keyCode == 13) Todo.generateTodo();
			});
		}
		Todo.isSubmitShown = true;

	},

	hideSubmit: function()
	{
		if (Todo.isSubmitShown)
		{
			$(".in-form-submit").removeClass("nudge");
			Todo.isSubmitShown = false;
		}
	},

	generateTodo: function()
	{
		var tString = $("#todoInput").val();
		var timeStamp = Todo.generateTimestamp();
			timeStamp = timeStamp.substr(0, timeStamp.length - 29);

		// UserManager.updateWidget(payload);

		Todo.addToFrontEnd(tString, timeStamp);

	},

	generateTimestamp: function()
	{
		return new Date().toString();
	},

	addToFrontEnd: function(content, timestamp)
	{
		var rand = Math.floor(Math.random() * 3) + 1;
		var rand2 = Math.floor(Math.random() * 3) + 1;

		var noteColour = "note-colour-" + rand;
		var noteRotate = "note-rotation-" + rand2;

		var content = "<div class='todo-list-item note-base "+noteColour+" "+noteRotate+"'><i class='pin'></i><div class='todo-content'>"+ content +"</div><div class='todo-timestamp'>"+ timestamp +"</div></div>";
		
		$(content).hide().appendTo($("#outstandingTodos")).fadeIn();


		console.log(content, timestamp);
	}

};
</script>

